<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MD Vue Scorer</title>
    <link rel="stylesheet" href="./css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
      integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA=="
      crossorigin="anonymous"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="./favicon/favicon-16x16.png"
    />
    <link rel="manifest" href="./favicon/site.webmanifest" />
    <link
      rel="mask-icon"
      href="./favicon/safari-pinned-tab.svg"
      color="#5bbad5"
    />
    <link rel="shortcut icon" href="./favicon/favicon.ico" />
    <meta name="msapplication-TileColor" content="#00a300" />
    <meta name="msapplication-config" content="./favicon/browserconfig.xml" />
    <meta name="theme-color" content="#ffffff" />
  </head>
  <body>
    <div id="app">
      <div class="container">
        <center>
          <div
            id="searchbox"
            :class="{focus: searching}"
            class="animate__animated animate__fadeInUp"
          >
            <img src="./img/icon-search.svg" alt="search-icon" />
            <input
              type="text"
              placeholder="Search your student ID"
              v-model="id"
              @blur="searching = false"
              @focus="searching = true"
              @click="reset()"
            />
          </div>
          <ul id="dropdown" v-if="student.length == 0 && id != ''">
            <li v-for="std in currentStudent">
              <a
                href="#"
                @click="student = std; getProfileImage(student.name);id= ''"
              >
                {{ std.name }} {{ std.surname }}
                <span class="username">@{{ std.id }}</span>
              </a>
            </li>
          </ul>
        </center>
        <center
          class="animate__animated animate__fadeInUp"
          v-if="student.length == 0"
        >
          <div style="color: #657786" v-if="id == ''">
            Searching your ID . . .
          </div>
        </center>
        <div class="display" v-else>
          <div class="information">
            <div id="profileImage" :style="{background: profileColor }">
              <img
                class="profilePicture"
                :src="getProfileImage(student.name)"
                alt="profilePicture"
              />
            </div>
            <div class="name">
              <h3>{{ student.name }} {{ student.surname }}</h3>
              <p>@{{ student.id }}</p>
            </div>
          </div>

          <div
            id="authenticator"
            class="animate__animated animate__fadeInUp"
            v-if="!authenticated"
          >
            <center>
              <h1>Enter password</h1>
              <form
                @submit.prevent="inputPassword === student.password ? authenticated = true : error = 'wrong password'"
              >
                <input
                  class="input"
                  type="password"
                  :placeholder="placeholder"
                  v-model="inputPassword"
                  @click="inputPassword = student.password; error = ''; placeholder = ''"
                  @blur="placeholder = '* * * * * * * *'"
                />
                <br />
                <button id="submit" type="submit">Enter</button>
              </form>
              <div class="error">{{ error }}</div>
            </center>
          </div>

          <div id="authenticated" v-else>
            <div class="missing">
              <p v-if="missingWorks.length == 0">
                You are not missing any work. Well done!
              </p>
              <p v-else>You are missing following work(s):</p>
              <ul>
                <li v-for="work in missingWorks">
                  <p>
                    {{works[work]}}
                    <a
                      href="https://bit.ly/2HnbdKd"
                      v-if="work == 'comp_design'"
                      target="_blank"
                    >
                      <i class="fas fa-search"></i>
                    </a>
                    <a
                      href="https://bit.ly/37rFQt5"
                      v-if="work == 'cc_license'"
                      target="_blank"
                    >
                      <i class="fas fa-search"></i>
                    </a>
                    <a
                      href="https://materbangkok-my.sharepoint.com/:x:/g/personal/bunnasorn_k_m_materdei_ac_th/EV18gsHpht9OjLhlnlXJDbwBj8qx2uOFPGk87x3mUjx9TA?e=qUrGbi"
                      v-if="work == 'excel'"
                      target="_blank"
                    >
                      <i class="fas fa-search"></i>
                    </a>
                    <a
                      href="https://materbangkok-my.sharepoint.com/:i:/g/personal/bunnasorn_k_m_materdei_ac_th/EeANvj9UDYhFs_ldvighhHcBwtLWxR9W5CXHQQXpMSQWUw"
                      v-if="work == 'tree'"
                      target="_blank"
                    >
                      <i class="fas fa-search"></i>
                    </a>
                  </p>
                </li>
              </ul>
              <a
                v-if="missingWorks.length != 0"
                href="mailto:bunnasorn.k@m.materdei.ac.th"
              >
                <div class="btn">
                  ส่งงาน&nbsp;
                  <i class="fas fa-share"></i>
                </div>
              </a>
            </div>
            <br />
            <div class="works animate__animated animate__fadeInDown">
              <table>
                <tr>
                  <td class="work">PowerApp: Portfolio</td>
                  <td class="score">{{student.portfolio}}</td>
                </tr>
                <tr>
                  <td class="work">PowerApp: BMI Calculator</td>
                  <td class="score">{{student.bmi}}</td>
                </tr>
                <tr>
                  <td class="work">Exercise: Computer Design</td>
                  <td class="score">{{student.comp_design}}</td>
                </tr>
                <tr>
                  <td class="work">Exercise: CC License</td>
                  <td class="score">{{student.cc_license}}</td>
                </tr>
                <tr>
                  <td class="work">Exercise: Excel</td>
                  <td class="score">{{student.excel}}</td>
                </tr>
                <tr>
                  <td class="work">Exercise: Examinature</td>
                  <td class="score">{{student.tree}}</td>
                </tr>
                <tr>
                  <td id="final" class="work">
                    <p>Final Exam</p>
                    <span v-if="final_score < 12"
                      ><a href="#" @click="alert('รองานซ่อมวันที่ 11')"
                        >สอบซ่อม</a
                      >
                    </span>
                  </td>
                  <td class="score">{{final_score}}</td>
                </tr>
              </table>
              <p class="note">updated on: {{ formatDate(last_updated) }}</p>
            </div>
            <div class="calculated">
              <div id="percircle">
                <svg>
                  <circle cx="50%" cy="50%" r="45%"></circle>
                  <circle
                    id="progress"
                    :style="{stroke: progress.color, 'stroke-dashoffset': progress.percent}"
                    cx="50%"
                    cy="50%"
                    r="45%"
                  ></circle>
                </svg>
                <div class="number">
                  <h2>{{total_score}}<span>%</span></h2>
                </div>
              </div>
              <p>Expected Grade: {{grading}}</p>

              <br />
              <div class="logout">
                <a href="#" @click="reset()"> logout </a>
              </div>
            </div>
          </div>
        </div>

        <footer>
          Made with <i class="fa fa-heart pulse red"></i> for Materdei School's
          Student <br />
          <a href="mailto:bunnasorn.k@m.materdei.ac.th">Bunnasorn Kaewsiri</a>
          All Rights Reserved <br />

          This work is licensed under a
          <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"
            >Creative Commons Attribution 4.0 International License</a
          >.
        </footer>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.21.0"></script>
    <script src="./js/main.js"></script>
  </body>
</html>
